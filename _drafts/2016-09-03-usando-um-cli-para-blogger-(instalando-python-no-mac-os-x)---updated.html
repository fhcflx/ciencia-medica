---
layout: post
title: Usando um CLI para blogger (instalando Python no Mac OS X) - updated
date: '2016-09-03T21:12:00.000-03:00'
author: Francisco H C Felix
tags:
- Blogger
- Mac OS X
- CLI
modified_time: '2016-09-03T21:12:22.942-03:00'
blogger_id: tag:blogger.com,1999:blog-2993346515708552092.post-8168546768034897038
---

<p>Esta postagem está sendo escrita em Markdown usando <strong>Vim</strong> e <a href="https://atom.io"><strong>Atom</strong></a> e será interpretada para HTML com <a href="http://pandoc.org"><strong>pandoc</strong></a>, para depois ser postada com <a href="http://www.crankyotaku.com/2016/03/command-line-blogger.html"><strong>crankyblogger</strong></a>, um CLI para blogger.com escrito em <a href="https://www.python.org"><strong>Python</strong></a>.</p><p>Ele é muito simples e capaz basicamente apenas de criar novas postagens no blogger. Desde que se tenha uma conta nele, claro. Para usá-lo, eu tive que instalar algumas<br />dependências. Estes são os pacotes que crankyblogger.py chama ao inicializar:</p><pre class="{python}"><code>import json, webbrowser, getopt, os.path, sys<br />import httplib2<br />from oauth2client import client<br />from apiclient.discovery import build<br />from oauth2client.file import Storage</code></pre><p>Meu sistema é <em>Mac OS X 10.11.6 El Capitan</em>. A versão de Python que vem embarcada é 2.7.10, instalada no diretório <code>/usr/bin/python</code>. Por definição, o sistema protege as pastas <code>/System /bin /sbin /usr</code> contra edição, mesmo usando usuário <em>root</em>. A Apple chama isso de <em>SIP - System Integrity Protection</em>. Na verdade, é uma característica interessante do ponto de vista de organização. Usando o <a href="http://brew.sh"><em>Homebrew</em></a> é possível fazer instalações seguras e funcionais que ficarão localizadas na pasta <code>/usr/local/bin</code>, eliminando problemas de compatibilidade. Como eu não poderia instalar as dependências necessárias no Python nativo do OS X, tive que instalar a última versão estável do Python 2.7. Antes de fazer isso, é necessário instalar as ferramentas de desenvolvedor do <em>Xcode</em> (via Apple Store) e o <em>Command Line Tools</em>:</p><pre><code>$ xcode-select --install</code></pre><p>Depois, é só instalar o Homebrew, se já não estiver no sistema:</p><pre><code>$ ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></pre><p>E, antes de instalar o Python, colocar a pasta de destino no $PATH:</p><pre><code>export PATH=/usr/local/bin:$PATH</code></pre><p>Esta linha pode ser acrescentada no <code>~/.bash_profile</code> para maior comodidade.<br />Por fim, para instalar a nova versão do Python:</p><pre><code>$ brew install python</code></pre><p>Checando a versão e o local:</p><pre><code>$ which python<br />/usr/local/bin/<br /><br />$ python --version<br />Python 2.7.12</code></pre><p>Usar o Homebrew para instalar outra versão de Python permite que a versão nativa conviva harmoniosamente com a nova. É possível até instalar o <em>Python 3.X</em> e usá-lo separadamente, sem interferir com as outras. As instruções de <a href="http://www.marinamele.com/python"><em>Marina Mele</em></a> são esclarecedoras. A melhor forma de instalar dependências específicas no Python é usando um ambiente virtual, para assegurar separação e organização das diversas instâncias.</p><p>Para instalar <em>virtualenv</em> e <em>virtualenvwrapper</em>:</p><pre><code>$ pip install virtualenv<br />$ pip install virtualenvwrapper</code></pre><p>Em seguida, criar uma pasta que vai conter os ambientes virtuais.</p><pre><code>$ mkdir ~/.virtualenvs</code></pre><p>Abrir ou criar o arquivo ~/.bashrc e colocar:</p><pre><code>export WORKON_HOME=~/.virtualenvs<br />source /usr/local/bin/virtualenvwrapper.sh</code></pre><p>Por fim, ativar estas mudanças:</p><pre><code>$ source ~/.bashrc</code></pre><p>Dessa forma, será possível criar um novo ambiente virtual:</p><pre><code>$ mkvirtualenv myenviroment</code></pre><p>Na pasta <code>~/.vitualenvs/myenvironment</code> que será criada pelo script. O ambiente será automaticamente ativo. Trocar de ambiente é simples como:</p><pre><code>$ workon myenvironment</code></pre><p>E, para desativar os ambientes:</p><pre><code>$ deactivate</code></pre><p>Deletar e listar os ambientes:</p><pre><code>$ rmvirtualenv &lt;nome_do_ambiente&gt;<br />$ lsvirtualenv</code></pre><p>Finalmente, instalar pacotes à vontade será fácil apenas usando o comando <code>pip install</code>. Instalei as dependências do crankyblogger.py dessa forma e pude usá-lo.</p><pre><code>$ pip install httplib2<br />$ pip install oauth2client<br />$ pip install --upgrade google-api-python-client</code></pre><p>Seu uso também é muito simples, consistindo apenas numa ferramenta para publicar novas postagens em formato rascunho (padrão) ou publicação final. Igualmente, pode-se configurar o título e marcadores para a postagem. A publicação é realmente simples com o uso desta ferramenta bem básica. Sua <a href="http://www.crankyotaku.com/2016/03/command-line-blogger.html">documentação</a> traz uma explicação sumária, porém suficiente para usá-lo. Para minha comodidade, mudei o nome do executável para <code>bloggercli</code> e copiei-o para a pasta <code>/usr/local/bin</code>. Dessa forma, posso usar o comando em qualquer local. Usei-o com um ambiente virtual:</p><pre><code>$ workon myenvironment<br />$ bloggercli -f &quot;newpost.html&quot; -t &quot;Usando um CLI para blogger (instalando Python no Mac OS X)&quot; -l &quot;Mac OS X, Blogger, CLI, Python&quot;</code></pre><p>Para criar o arquivo em html, escrevi <code>newpost.txt</code> usando Markdown e usei o pandoc para convertê-lo:</p><pre><code>$ pandoc -f markdown_strict -t html -o newpost.html newpost.txt</code></pre><p>Este é meu primeiro teste.</p>